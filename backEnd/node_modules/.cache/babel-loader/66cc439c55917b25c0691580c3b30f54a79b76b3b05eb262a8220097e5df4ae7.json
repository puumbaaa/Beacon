{"ast":null,"code":"// FunctionHelper\n// -------\n// Used for adding functions from the builder\n// Example usage: table.dateTime('datetime_to_date').notNull().defaultTo(knex.fn.now());\nclass FunctionHelper {\n  constructor(client) {\n    this.client = client;\n  }\n  now(precision) {\n    if (typeof precision === 'number') {\n      return this.client.raw(`CURRENT_TIMESTAMP(${precision})`);\n    }\n    return this.client.raw('CURRENT_TIMESTAMP');\n  }\n  uuid() {\n    switch (this.client.driverName) {\n      case 'sqlite3':\n      case 'better-sqlite3':\n        return this.client.raw(\"(lower(hex(randomblob(4))) || '-' || lower(hex(randomblob(2))) || '-4' || substr(lower(hex(randomblob(2))),2) || '-' || substr('89ab',abs(random()) % 4 + 1, 1) || substr(lower(hex(randomblob(2))),2) || '-' || lower(hex(randomblob(6))))\");\n      case 'mssql':\n        return this.client.raw('(NEWID())');\n      case 'pg':\n      case 'pgnative':\n      case 'cockroachdb':\n        return this.client.raw('(gen_random_uuid())');\n      case 'oracle':\n      case 'oracledb':\n        return this.client.raw('(random_uuid())');\n      case 'mysql':\n      case 'mysql2':\n        return this.client.raw('(UUID())');\n      default:\n        throw new Error(`${this.client.driverName} does not have a uuid function`);\n    }\n  }\n  uuidToBin(uuid, ordered = true) {\n    const buf = Buffer.from(uuid.replace(/-/g, ''), 'hex');\n    return ordered ? Buffer.concat([buf.slice(6, 8), buf.slice(4, 6), buf.slice(0, 4), buf.slice(8, 16)]) : Buffer.concat([buf.slice(0, 4), buf.slice(4, 6), buf.slice(6, 8), buf.slice(8, 16)]);\n  }\n  binToUuid(bin, ordered = true) {\n    const buf = Buffer.from(bin, 'hex');\n    return ordered ? [buf.toString('hex', 4, 8), buf.toString('hex', 2, 4), buf.toString('hex', 0, 2), buf.toString('hex', 8, 10), buf.toString('hex', 10, 16)].join('-') : [buf.toString('hex', 0, 4), buf.toString('hex', 4, 6), buf.toString('hex', 6, 8), buf.toString('hex', 8, 10), buf.toString('hex', 10, 16)].join('-');\n  }\n}\nmodule.exports = FunctionHelper;","map":{"version":3,"names":["FunctionHelper","constructor","client","now","precision","raw","uuid","driverName","Error","uuidToBin","ordered","buf","Buffer","from","replace","concat","slice","binToUuid","bin","toString","join","module","exports"],"sources":["C:/Users/momo1/Documents/@DevPerso/Beacon/node_modules/knex/lib/knex-builder/FunctionHelper.js"],"sourcesContent":["// FunctionHelper\n// -------\n// Used for adding functions from the builder\n// Example usage: table.dateTime('datetime_to_date').notNull().defaultTo(knex.fn.now());\nclass FunctionHelper {\n  constructor(client) {\n    this.client = client;\n  }\n\n  now(precision) {\n    if (typeof precision === 'number') {\n      return this.client.raw(`CURRENT_TIMESTAMP(${precision})`);\n    }\n    return this.client.raw('CURRENT_TIMESTAMP');\n  }\n\n  uuid() {\n    switch (this.client.driverName) {\n      case 'sqlite3':\n      case 'better-sqlite3':\n        return this.client.raw(\n          \"(lower(hex(randomblob(4))) || '-' || lower(hex(randomblob(2))) || '-4' || substr(lower(hex(randomblob(2))),2) || '-' || substr('89ab',abs(random()) % 4 + 1, 1) || substr(lower(hex(randomblob(2))),2) || '-' || lower(hex(randomblob(6))))\"\n        );\n      case 'mssql':\n        return this.client.raw('(NEWID())');\n      case 'pg':\n      case 'pgnative':\n      case 'cockroachdb':\n        return this.client.raw('(gen_random_uuid())');\n      case 'oracle':\n      case 'oracledb':\n        return this.client.raw('(random_uuid())');\n      case 'mysql':\n      case 'mysql2':\n        return this.client.raw('(UUID())');\n      default:\n        throw new Error(\n          `${this.client.driverName} does not have a uuid function`\n        );\n    }\n  }\n\n  uuidToBin(uuid, ordered = true) {\n    const buf = Buffer.from(uuid.replace(/-/g, ''), 'hex');\n    return ordered\n      ? Buffer.concat([\n          buf.slice(6, 8),\n          buf.slice(4, 6),\n          buf.slice(0, 4),\n          buf.slice(8, 16),\n        ])\n      : Buffer.concat([\n          buf.slice(0, 4),\n          buf.slice(4, 6),\n          buf.slice(6, 8),\n          buf.slice(8, 16),\n        ]);\n  }\n\n  binToUuid(bin, ordered = true) {\n    const buf = Buffer.from(bin, 'hex');\n    return ordered\n      ? [\n          buf.toString('hex', 4, 8),\n          buf.toString('hex', 2, 4),\n          buf.toString('hex', 0, 2),\n          buf.toString('hex', 8, 10),\n          buf.toString('hex', 10, 16),\n        ].join('-')\n      : [\n          buf.toString('hex', 0, 4),\n          buf.toString('hex', 4, 6),\n          buf.toString('hex', 6, 8),\n          buf.toString('hex', 8, 10),\n          buf.toString('hex', 10, 16),\n        ].join('-');\n  }\n}\n\nmodule.exports = FunctionHelper;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}