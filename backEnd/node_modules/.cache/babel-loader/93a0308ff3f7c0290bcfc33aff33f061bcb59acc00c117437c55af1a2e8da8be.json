{"ast":null,"code":"const {\n  columnize\n} = require('./wrappingFormatter');\nfunction replaceRawArrBindings(raw, client) {\n  const bindingsHolder = {\n    bindings: []\n  };\n  const builder = raw;\n  const expectedBindings = raw.bindings.length;\n  const values = raw.bindings;\n  let index = 0;\n  const sql = raw.sql.replace(/\\\\?\\?\\??/g, function (match) {\n    if (match === '\\\\?') {\n      return match;\n    }\n    const value = values[index++];\n    if (match === '??') {\n      return columnize(value, builder, client, bindingsHolder);\n    }\n    return client.parameter(value, builder, bindingsHolder);\n  });\n  if (expectedBindings !== index) {\n    throw new Error(`Expected ${expectedBindings} bindings, saw ${index}`);\n  }\n  return {\n    method: 'raw',\n    sql,\n    bindings: bindingsHolder.bindings\n  };\n}\nfunction replaceKeyBindings(raw, client) {\n  const bindingsHolder = {\n    bindings: []\n  };\n  const builder = raw;\n  const values = raw.bindings;\n  const regex = /\\\\?(:(\\w+):(?=::)|:(\\w+):(?!:)|:(\\w+))/g;\n  const sql = raw.sql.replace(regex, function (match, p1, p2, p3, p4) {\n    if (match !== p1) {\n      return p1;\n    }\n    const part = p2 || p3 || p4;\n    const key = match.trim();\n    const isIdentifier = key[key.length - 1] === ':';\n    const value = values[part];\n    if (value === undefined) {\n      if (Object.prototype.hasOwnProperty.call(values, part)) {\n        bindingsHolder.bindings.push(value);\n      }\n      return match;\n    }\n    if (isIdentifier) {\n      return match.replace(p1, columnize(value, builder, client, bindingsHolder));\n    }\n    return match.replace(p1, client.parameter(value, builder, bindingsHolder));\n  });\n  return {\n    method: 'raw',\n    sql,\n    bindings: bindingsHolder.bindings\n  };\n}\nmodule.exports = {\n  replaceKeyBindings,\n  replaceRawArrBindings\n};","map":{"version":3,"names":["columnize","require","replaceRawArrBindings","raw","client","bindingsHolder","bindings","builder","expectedBindings","length","values","index","sql","replace","match","value","parameter","Error","method","replaceKeyBindings","regex","p1","p2","p3","p4","part","key","trim","isIdentifier","undefined","Object","prototype","hasOwnProperty","call","push","module","exports"],"sources":["C:/Users/momo1/Documents/@DevPerso/Beacon/node_modules/knex/lib/formatter/rawFormatter.js"],"sourcesContent":["const { columnize } = require('./wrappingFormatter');\n\nfunction replaceRawArrBindings(raw, client) {\n  const bindingsHolder = {\n    bindings: [],\n  };\n  const builder = raw;\n\n  const expectedBindings = raw.bindings.length;\n  const values = raw.bindings;\n  let index = 0;\n\n  const sql = raw.sql.replace(/\\\\?\\?\\??/g, function (match) {\n    if (match === '\\\\?') {\n      return match;\n    }\n\n    const value = values[index++];\n\n    if (match === '??') {\n      return columnize(value, builder, client, bindingsHolder);\n    }\n    return client.parameter(value, builder, bindingsHolder);\n  });\n\n  if (expectedBindings !== index) {\n    throw new Error(`Expected ${expectedBindings} bindings, saw ${index}`);\n  }\n\n  return {\n    method: 'raw',\n    sql,\n    bindings: bindingsHolder.bindings,\n  };\n}\n\nfunction replaceKeyBindings(raw, client) {\n  const bindingsHolder = {\n    bindings: [],\n  };\n  const builder = raw;\n\n  const values = raw.bindings;\n  const regex = /\\\\?(:(\\w+):(?=::)|:(\\w+):(?!:)|:(\\w+))/g;\n\n  const sql = raw.sql.replace(regex, function (match, p1, p2, p3, p4) {\n    if (match !== p1) {\n      return p1;\n    }\n\n    const part = p2 || p3 || p4;\n    const key = match.trim();\n    const isIdentifier = key[key.length - 1] === ':';\n    const value = values[part];\n\n    if (value === undefined) {\n      if (Object.prototype.hasOwnProperty.call(values, part)) {\n        bindingsHolder.bindings.push(value);\n      }\n\n      return match;\n    }\n\n    if (isIdentifier) {\n      return match.replace(\n        p1,\n        columnize(value, builder, client, bindingsHolder)\n      );\n    }\n\n    return match.replace(p1, client.parameter(value, builder, bindingsHolder));\n  });\n\n  return {\n    method: 'raw',\n    sql,\n    bindings: bindingsHolder.bindings,\n  };\n}\n\nmodule.exports = {\n  replaceKeyBindings,\n  replaceRawArrBindings,\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}