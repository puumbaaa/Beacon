{"ast":null,"code":"const Transaction = require('../../execution/transaction');\nconst Debug = require('debug');\nconst debug = Debug('knex:tx');\nclass Transaction_MySQL extends Transaction {\n  query(conn, sql, status, value) {\n    const t = this;\n    const q = this.trxClient.query(conn, sql).catch(err => {\n      if (err.errno === 1305) {\n        this.trxClient.logger.warn('Transaction was implicitly committed, do not mix transactions and ' + 'DDL with MySQL (#805)');\n        return;\n      }\n      status = 2;\n      value = err;\n      t._completed = true;\n      debug('%s error running transaction query', t.txid);\n    }).then(function (res) {\n      if (status === 1) t._resolver(value);\n      if (status === 2) {\n        if (value === undefined) {\n          if (t.doNotRejectOnRollback && /^ROLLBACK\\b/i.test(sql)) {\n            t._resolver();\n            return;\n          }\n          value = new Error(`Transaction rejected with non-error: ${value}`);\n        }\n        t._rejecter(value);\n      }\n      return res;\n    });\n    if (status === 1 || status === 2) {\n      t._completed = true;\n    }\n    return q;\n  }\n}\nmodule.exports = Transaction_MySQL;","map":{"version":3,"names":["Transaction","require","Debug","debug","Transaction_MySQL","query","conn","sql","status","value","t","q","trxClient","catch","err","errno","logger","warn","_completed","txid","then","res","_resolver","undefined","doNotRejectOnRollback","test","Error","_rejecter","module","exports"],"sources":["C:/Users/momo1/Documents/@DevPerso/Beacon/node_modules/knex/lib/dialects/mysql/transaction.js"],"sourcesContent":["const Transaction = require('../../execution/transaction');\nconst Debug = require('debug');\n\nconst debug = Debug('knex:tx');\n\nclass Transaction_MySQL extends Transaction {\n  query(conn, sql, status, value) {\n    const t = this;\n    const q = this.trxClient\n      .query(conn, sql)\n      .catch((err) => {\n        if (err.errno === 1305) {\n          this.trxClient.logger.warn(\n            'Transaction was implicitly committed, do not mix transactions and ' +\n              'DDL with MySQL (#805)'\n          );\n          return;\n        }\n\n        status = 2;\n        value = err;\n        t._completed = true;\n        debug('%s error running transaction query', t.txid);\n      })\n      .then(function (res) {\n        if (status === 1) t._resolver(value);\n        if (status === 2) {\n          if (value === undefined) {\n            if (t.doNotRejectOnRollback && /^ROLLBACK\\b/i.test(sql)) {\n              t._resolver();\n              return;\n            }\n            value = new Error(`Transaction rejected with non-error: ${value}`);\n          }\n          t._rejecter(value);\n        }\n        return res;\n      });\n    if (status === 1 || status === 2) {\n      t._completed = true;\n    }\n    return q;\n  }\n}\n\nmodule.exports = Transaction_MySQL;\n"],"mappings":"AAAA,MAAMA,WAAW,GAAGC,OAAO,CAAC,6BAA6B,CAAC;AAC1D,MAAMC,KAAK,GAAGD,OAAO,CAAC,OAAO,CAAC;AAE9B,MAAME,KAAK,GAAGD,KAAK,CAAC,SAAS,CAAC;AAE9B,MAAME,iBAAiB,SAASJ,WAAW,CAAC;EAC1CK,KAAKA,CAACC,IAAI,EAAEC,GAAG,EAAEC,MAAM,EAAEC,KAAK,EAAE;IAC9B,MAAMC,CAAC,GAAG,IAAI;IACd,MAAMC,CAAC,GAAG,IAAI,CAACC,SAAS,CACrBP,KAAK,CAACC,IAAI,EAAEC,GAAG,CAAC,CAChBM,KAAK,CAAEC,GAAG,IAAK;MACd,IAAIA,GAAG,CAACC,KAAK,KAAK,IAAI,EAAE;QACtB,IAAI,CAACH,SAAS,CAACI,MAAM,CAACC,IAAI,CACxB,oEAAoE,GAClE,uBACJ,CAAC;QACD;MACF;MAEAT,MAAM,GAAG,CAAC;MACVC,KAAK,GAAGK,GAAG;MACXJ,CAAC,CAACQ,UAAU,GAAG,IAAI;MACnBf,KAAK,CAAC,oCAAoC,EAAEO,CAAC,CAACS,IAAI,CAAC;IACrD,CAAC,CAAC,CACDC,IAAI,CAAC,UAAUC,GAAG,EAAE;MACnB,IAAIb,MAAM,KAAK,CAAC,EAAEE,CAAC,CAACY,SAAS,CAACb,KAAK,CAAC;MACpC,IAAID,MAAM,KAAK,CAAC,EAAE;QAChB,IAAIC,KAAK,KAAKc,SAAS,EAAE;UACvB,IAAIb,CAAC,CAACc,qBAAqB,IAAI,cAAc,CAACC,IAAI,CAAClB,GAAG,CAAC,EAAE;YACvDG,CAAC,CAACY,SAAS,CAAC,CAAC;YACb;UACF;UACAb,KAAK,GAAG,IAAIiB,KAAK,CAAC,wCAAwCjB,KAAK,EAAE,CAAC;QACpE;QACAC,CAAC,CAACiB,SAAS,CAAClB,KAAK,CAAC;MACpB;MACA,OAAOY,GAAG;IACZ,CAAC,CAAC;IACJ,IAAIb,MAAM,KAAK,CAAC,IAAIA,MAAM,KAAK,CAAC,EAAE;MAChCE,CAAC,CAACQ,UAAU,GAAG,IAAI;IACrB;IACA,OAAOP,CAAC;EACV;AACF;AAEAiB,MAAM,CAACC,OAAO,GAAGzB,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}