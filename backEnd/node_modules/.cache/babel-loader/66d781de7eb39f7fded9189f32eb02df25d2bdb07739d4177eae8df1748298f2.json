{"ast":null,"code":"const _debugQuery = require('debug')('knex:query');\nconst debugBindings = require('debug')('knex:bindings');\nconst debugQuery = (sql, txId) => _debugQuery(sql.replace(/%/g, '%%'), txId);\nconst {\n  isString\n} = require('../../util/is');\nfunction formatQuery(sql, bindings, timeZone, client) {\n  bindings = bindings == null ? [] : [].concat(bindings);\n  let index = 0;\n  return sql.replace(/\\\\?\\?/g, match => {\n    if (match === '\\\\?') {\n      return '?';\n    }\n    if (index === bindings.length) {\n      return match;\n    }\n    const value = bindings[index++];\n    return client._escapeBinding(value, {\n      timeZone\n    });\n  });\n}\nfunction enrichQueryObject(connection, queryParam, client) {\n  const queryObject = isString(queryParam) ? {\n    sql: queryParam\n  } : queryParam;\n  queryObject.bindings = client.prepBindings(queryObject.bindings);\n  queryObject.sql = client.positionBindings(queryObject.sql);\n  const {\n    __knexUid,\n    __knexTxId\n  } = connection;\n  client.emit('query', Object.assign({\n    __knexUid,\n    __knexTxId\n  }, queryObject));\n  debugQuery(queryObject.sql, __knexTxId);\n  debugBindings(queryObject.bindings, __knexTxId);\n  return queryObject;\n}\nfunction executeQuery(connection, queryObject, client) {\n  return client._query(connection, queryObject).catch(err => {\n    if (client.config && client.config.compileSqlOnError === false) {\n      err.message = queryObject.sql + ' - ' + err.message;\n    } else {\n      err.message = formatQuery(queryObject.sql, queryObject.bindings, undefined, client) + ' - ' + err.message;\n    }\n    client.emit('query-error', err, Object.assign({\n      __knexUid: connection.__knexUid,\n      __knexTxId: connection.__knexUid\n    }, queryObject));\n    throw err;\n  });\n}\nmodule.exports = {\n  enrichQueryObject,\n  executeQuery,\n  formatQuery\n};","map":{"version":3,"names":["_debugQuery","require","debugBindings","debugQuery","sql","txId","replace","isString","formatQuery","bindings","timeZone","client","concat","index","match","length","value","_escapeBinding","enrichQueryObject","connection","queryParam","queryObject","prepBindings","positionBindings","__knexUid","__knexTxId","emit","Object","assign","executeQuery","_query","catch","err","config","compileSqlOnError","message","undefined","module","exports"],"sources":["C:/Users/momo1/Documents/@DevPerso/Beacon/node_modules/knex/lib/execution/internal/query-executioner.js"],"sourcesContent":["const _debugQuery = require('debug')('knex:query');\nconst debugBindings = require('debug')('knex:bindings');\nconst debugQuery = (sql, txId) => _debugQuery(sql.replace(/%/g, '%%'), txId);\nconst { isString } = require('../../util/is');\n\nfunction formatQuery(sql, bindings, timeZone, client) {\n  bindings = bindings == null ? [] : [].concat(bindings);\n  let index = 0;\n  return sql.replace(/\\\\?\\?/g, (match) => {\n    if (match === '\\\\?') {\n      return '?';\n    }\n    if (index === bindings.length) {\n      return match;\n    }\n    const value = bindings[index++];\n    return client._escapeBinding(value, { timeZone });\n  });\n}\n\nfunction enrichQueryObject(connection, queryParam, client) {\n  const queryObject = isString(queryParam) ? { sql: queryParam } : queryParam;\n\n  queryObject.bindings = client.prepBindings(queryObject.bindings);\n  queryObject.sql = client.positionBindings(queryObject.sql);\n\n  const { __knexUid, __knexTxId } = connection;\n\n  client.emit('query', Object.assign({ __knexUid, __knexTxId }, queryObject));\n  debugQuery(queryObject.sql, __knexTxId);\n  debugBindings(queryObject.bindings, __knexTxId);\n\n  return queryObject;\n}\n\nfunction executeQuery(connection, queryObject, client) {\n  return client._query(connection, queryObject).catch((err) => {\n    if (client.config && client.config.compileSqlOnError === false) {\n      err.message = queryObject.sql + ' - ' + err.message;\n    } else {\n      err.message =\n        formatQuery(queryObject.sql, queryObject.bindings, undefined, client) +\n        ' - ' +\n        err.message;\n    }\n    client.emit(\n      'query-error',\n      err,\n      Object.assign(\n        { __knexUid: connection.__knexUid, __knexTxId: connection.__knexUid },\n        queryObject\n      )\n    );\n    throw err;\n  });\n}\n\nmodule.exports = {\n  enrichQueryObject,\n  executeQuery,\n  formatQuery,\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}