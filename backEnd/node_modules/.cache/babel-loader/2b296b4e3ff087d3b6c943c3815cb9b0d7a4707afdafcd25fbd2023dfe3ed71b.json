{"ast":null,"code":"/* eslint max-len: 0 */\n\nconst ViewCompiler = require('../../../schema/viewcompiler.js');\nconst {\n  columnize: columnize_\n} = require('../../../formatter/wrappingFormatter');\nclass ViewCompiler_MSSQL extends ViewCompiler {\n  constructor(client, viewCompiler) {\n    super(client, viewCompiler);\n  }\n  createQuery(columns, selectQuery, materialized, replace) {\n    const createStatement = 'CREATE ' + (replace ? 'OR ALTER ' : '') + 'VIEW ';\n    let sql = createStatement + this.viewName();\n    const columnList = columns ? ' (' + columnize_(columns, this.viewBuilder, this.client, this.bindingsHolder) + ')' : '';\n    sql += columnList;\n    sql += ' AS ';\n    sql += selectQuery.toString();\n    this.pushQuery({\n      sql\n    });\n  }\n  renameColumn(from, to) {\n    this.pushQuery(`exec sp_rename ${this.client.parameter(this.viewName() + '.' + from, this.viewBuilder, this.bindingsHolder)}, ${this.client.parameter(to, this.viewBuilder, this.bindingsHolder)}, 'COLUMN'`);\n  }\n  createOrReplace() {\n    this.createQuery(this.columns, this.selectQuery, false, true);\n  }\n}\nmodule.exports = ViewCompiler_MSSQL;","map":{"version":3,"names":["ViewCompiler","require","columnize","columnize_","ViewCompiler_MSSQL","constructor","client","viewCompiler","createQuery","columns","selectQuery","materialized","replace","createStatement","sql","viewName","columnList","viewBuilder","bindingsHolder","toString","pushQuery","renameColumn","from","to","parameter","createOrReplace","module","exports"],"sources":["C:/Users/momo1/Documents/@DevPerso/Beacon/node_modules/knex/lib/dialects/mssql/schema/mssql-viewcompiler.js"],"sourcesContent":["/* eslint max-len: 0 */\n\nconst ViewCompiler = require('../../../schema/viewcompiler.js');\nconst {\n  columnize: columnize_,\n} = require('../../../formatter/wrappingFormatter');\n\nclass ViewCompiler_MSSQL extends ViewCompiler {\n  constructor(client, viewCompiler) {\n    super(client, viewCompiler);\n  }\n\n  createQuery(columns, selectQuery, materialized, replace) {\n    const createStatement = 'CREATE ' + (replace ? 'OR ALTER ' : '') + 'VIEW ';\n    let sql = createStatement + this.viewName();\n\n    const columnList = columns\n      ? ' (' +\n        columnize_(\n          columns,\n          this.viewBuilder,\n          this.client,\n          this.bindingsHolder\n        ) +\n        ')'\n      : '';\n\n    sql += columnList;\n    sql += ' AS ';\n    sql += selectQuery.toString();\n    this.pushQuery({\n      sql,\n    });\n  }\n\n  renameColumn(from, to) {\n    this.pushQuery(\n      `exec sp_rename ${this.client.parameter(\n        this.viewName() + '.' + from,\n        this.viewBuilder,\n        this.bindingsHolder\n      )}, ${this.client.parameter(\n        to,\n        this.viewBuilder,\n        this.bindingsHolder\n      )}, 'COLUMN'`\n    );\n  }\n\n  createOrReplace() {\n    this.createQuery(this.columns, this.selectQuery, false, true);\n  }\n}\n\nmodule.exports = ViewCompiler_MSSQL;\n"],"mappings":"AAAA;;AAEA,MAAMA,YAAY,GAAGC,OAAO,CAAC,iCAAiC,CAAC;AAC/D,MAAM;EACJC,SAAS,EAAEC;AACb,CAAC,GAAGF,OAAO,CAAC,sCAAsC,CAAC;AAEnD,MAAMG,kBAAkB,SAASJ,YAAY,CAAC;EAC5CK,WAAWA,CAACC,MAAM,EAAEC,YAAY,EAAE;IAChC,KAAK,CAACD,MAAM,EAAEC,YAAY,CAAC;EAC7B;EAEAC,WAAWA,CAACC,OAAO,EAAEC,WAAW,EAAEC,YAAY,EAAEC,OAAO,EAAE;IACvD,MAAMC,eAAe,GAAG,SAAS,IAAID,OAAO,GAAG,WAAW,GAAG,EAAE,CAAC,GAAG,OAAO;IAC1E,IAAIE,GAAG,GAAGD,eAAe,GAAG,IAAI,CAACE,QAAQ,CAAC,CAAC;IAE3C,MAAMC,UAAU,GAAGP,OAAO,GACtB,IAAI,GACJN,UAAU,CACRM,OAAO,EACP,IAAI,CAACQ,WAAW,EAChB,IAAI,CAACX,MAAM,EACX,IAAI,CAACY,cACP,CAAC,GACD,GAAG,GACH,EAAE;IAENJ,GAAG,IAAIE,UAAU;IACjBF,GAAG,IAAI,MAAM;IACbA,GAAG,IAAIJ,WAAW,CAACS,QAAQ,CAAC,CAAC;IAC7B,IAAI,CAACC,SAAS,CAAC;MACbN;IACF,CAAC,CAAC;EACJ;EAEAO,YAAYA,CAACC,IAAI,EAAEC,EAAE,EAAE;IACrB,IAAI,CAACH,SAAS,CACZ,kBAAkB,IAAI,CAACd,MAAM,CAACkB,SAAS,CACrC,IAAI,CAACT,QAAQ,CAAC,CAAC,GAAG,GAAG,GAAGO,IAAI,EAC5B,IAAI,CAACL,WAAW,EAChB,IAAI,CAACC,cACP,CAAC,KAAK,IAAI,CAACZ,MAAM,CAACkB,SAAS,CACzBD,EAAE,EACF,IAAI,CAACN,WAAW,EAChB,IAAI,CAACC,cACP,CAAC,YACH,CAAC;EACH;EAEAO,eAAeA,CAAA,EAAG;IAChB,IAAI,CAACjB,WAAW,CAAC,IAAI,CAACC,OAAO,EAAE,IAAI,CAACC,WAAW,EAAE,KAAK,EAAE,IAAI,CAAC;EAC/D;AACF;AAEAgB,MAAM,CAACC,OAAO,GAAGvB,kBAAkB","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}